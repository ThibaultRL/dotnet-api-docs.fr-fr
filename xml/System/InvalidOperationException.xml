<Type Name="InvalidOperationException" FullName="System.InvalidOperationException">
  <Metadata><Meta Name="ms.openlocfilehash" Value="810fe50283e801c3e7dde603475dc30ccd6ad1c8" /><Meta Name="ms.sourcegitcommit" Value="7845f124909a0999a19cc65f40feab5e75cd9b8d" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="fr-FR" /><Meta Name="ms.lasthandoff" Value="05/06/2019" /><Meta Name="ms.locfileid" Value="65064620" /></Metadata><TypeSignature Language="C#" Value="public class InvalidOperationException : SystemException" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi serializable beforefieldinit InvalidOperationException extends System.SystemException" />
  <TypeSignature Language="DocId" Value="T:System.InvalidOperationException" />
  <TypeSignature Language="VB.NET" Value="Public Class InvalidOperationException&#xA;Inherits SystemException" />
  <TypeSignature Language="C++ CLI" Value="public ref class InvalidOperationException : SystemException" />
  <TypeSignature Language="F#" Value="type InvalidOperationException = class&#xA;    inherit SystemException" />
  <AssemblyInfo>
    <AssemblyName>System.Runtime</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.10.0</AssemblyVersion>
    <AssemblyVersion>4.0.20.0</AssemblyVersion>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.1.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.1.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Exception</BaseTypeName>
    <BaseTypeName FrameworkAlternate="netframework-4.5">System.SystemException</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.Runtime.InteropServices.ComVisible(true)</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0">
      <AttributeName>System.Serializable</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="2a3e5-101">Exception levée en cas d'appel de méthode non valide pour l'état actuel de l'objet.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-101">The exception that is thrown when a method call is invalid for the object's current state.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2a3e5-102"><xref:System.InvalidOperationException> est utilisé lorsque l’échec pour appeler une méthode est dû à des raisons autres que des arguments non valides.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-102"><xref:System.InvalidOperationException> is used in cases when the failure to invoke a method is caused by reasons other than invalid arguments.</span></span> <span data-ttu-id="2a3e5-103">En règle générale, elle est levée lorsque l’état d’un objet ne peut pas prendre en charge l’appel de méthode.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-103">Typically, it is thrown when the state of an object cannot support the method call.</span></span> <span data-ttu-id="2a3e5-104">Par exemple, un <xref:System.InvalidOperationException> exception est levée par les méthodes telles que :</span><span class="sxs-lookup"><span data-stu-id="2a3e5-104">For example, an <xref:System.InvalidOperationException> exception is thrown by methods such as:</span></span>  
  
-   <span data-ttu-id="2a3e5-105"><xref:System.Collections.IEnumerator.MoveNext%2A?displayProperty=nameWithType> Si les objets d’une collection sont modifiés après la création de l’énumérateur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-105"><xref:System.Collections.IEnumerator.MoveNext%2A?displayProperty=nameWithType> if objects of a collection are modified after the enumerator is created.</span></span> <span data-ttu-id="2a3e5-106">Pour plus d’informations, consultez [modification d’une collection lors de l’itération il](#Iterating).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-106">For more information, see [Changing a collection while iterating it](#Iterating).</span></span>  
  
-   <span data-ttu-id="2a3e5-107"><xref:System.Resources.ResourceSet.GetString%2A?displayProperty=nameWithType> Si le jeu de ressources est fermé avant l’appel de méthode est effectué.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-107"><xref:System.Resources.ResourceSet.GetString%2A?displayProperty=nameWithType> if the resource set is closed before the method call is made.</span></span>  
  
-   <span data-ttu-id="2a3e5-108"><xref:System.Xml.Linq.XContainer.Add%2A?displayProperty=nameWithType>, si l’ou les objets à ajouter entraînerait un document XML structuré de manière incorrecte.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-108"><xref:System.Xml.Linq.XContainer.Add%2A?displayProperty=nameWithType>, if the object or objects to be added would result in an incorrectly structured XML document.</span></span>  
  
-   <span data-ttu-id="2a3e5-109">Une méthode qui tente de manipuler l’interface utilisateur à partir d’un thread qui n’est pas le principal ou le thread d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-109">A method that attempts to manipulate the UI from a thread that is not the main or UI thread.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="2a3e5-110">Étant donné que le <xref:System.InvalidOperationException> exception peut être levée dans un large éventail de circonstances, il est important de lire le message d’exception retourné par la <xref:System.Exception.Message%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-110">Because the <xref:System.InvalidOperationException> exception can be thrown in a wide variety of circumstances, it is important to read the exception message returned by the <xref:System.Exception.Message%2A> property.</span></span>  
  
 <span data-ttu-id="2a3e5-111">Dans cette section :</span><span class="sxs-lookup"><span data-stu-id="2a3e5-111">In this section:</span></span>  
  
 <span data-ttu-id="2a3e5-112">[Certaines causes courantes des exceptions de InvalidOperationException](#Causes) </span><span class="sxs-lookup"><span data-stu-id="2a3e5-112">[Some common causes of InvalidOperationException exceptions](#Causes) </span></span>  
 [<span data-ttu-id="2a3e5-113">La mise à jour d’un thread d’interface utilisateur à partir d’un thread non-interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="2a3e5-113">Updating a UI thread from a non-UI thread</span></span>](#UI)  
 [<span data-ttu-id="2a3e5-114">Modification d’une collection lors de l’itération il</span><span class="sxs-lookup"><span data-stu-id="2a3e5-114">Changing a collection while iterating it</span></span>](#Iterating)  
 [<span data-ttu-id="2a3e5-115">Tri d’un tableau ou une collection dont les objets ne peuvent pas être comparées.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-115">Sorting an array or collection whose objects cannot be compared</span></span>](#Sorting)  
 <span data-ttu-id="2a3e5-116">[Conversion d’un type Nullable&lt;T&gt; qui a la valeur null en son type sous-jacent](#Nullable) </span><span class="sxs-lookup"><span data-stu-id="2a3e5-116">[Casting a Nullable&lt;T&gt; that is null to its underlying type](#Nullable) </span></span>  
 [<span data-ttu-id="2a3e5-117">Appeler une méthode System.Linq.Enumerable sur une collection vide</span><span class="sxs-lookup"><span data-stu-id="2a3e5-117">Calling a System.Linq.Enumerable method on an empty collection</span></span>](#Empty)  
 [<span data-ttu-id="2a3e5-118">L’appel Enumerable.Single ou Enumerable.SingleOrDefault sur une séquence sans un seul élément</span><span class="sxs-lookup"><span data-stu-id="2a3e5-118">Calling Enumerable.Single or Enumerable.SingleOrDefault on a sequence without one element</span></span>](#Single)  
 [<span data-ttu-id="2a3e5-119">Accès aux champs de domaine d’applications croisées dynamiques</span><span class="sxs-lookup"><span data-stu-id="2a3e5-119">Dynamic cross-application domain field access</span></span>](#Emit)  
[<span data-ttu-id="2a3e5-120">Lever une exception InvalidOperationException</span><span class="sxs-lookup"><span data-stu-id="2a3e5-120">Throwing an InvalidOperationException exception</span></span>](#Throwing)  
[<span data-ttu-id="2a3e5-121">Informations diverses</span><span class="sxs-lookup"><span data-stu-id="2a3e5-121">Miscellaneous information</span></span>](#Misc)  
  
<a name="Causes"></a>   
## <a name="some-common-causes-of-invalidoperationexception-exceptions"></a><span data-ttu-id="2a3e5-122">Certaines causes courantes des exceptions de InvalidOperationException</span><span class="sxs-lookup"><span data-stu-id="2a3e5-122">Some common causes of InvalidOperationException exceptions</span></span>  
 <span data-ttu-id="2a3e5-123">Les sections suivantes montrent comment certaines les cas courants dans lesquels dans <xref:System.InvalidOperationException> exception est levée dans une application.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-123">The following sections show how some common cases in which in <xref:System.InvalidOperationException> exception is thrown in an app.</span></span> <span data-ttu-id="2a3e5-124">Façon dont vous gérez le problème dépend de la situation spécifique.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-124">How you handle the issue depends on the specific situation.</span></span> <span data-ttu-id="2a3e5-125">En règle générale, toutefois, l’exception résulte de l’erreur de développement et le <xref:System.InvalidOperationException> exception peut être anticipée et évitée.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-125">Most commonly, however, the exception results from developer error, and the <xref:System.InvalidOperationException> exception can be anticipated and avoided.</span></span>  
  
<a name="UI"></a>   
### <a name="updating-a-ui-thread-from-a-non-ui-thread"></a><span data-ttu-id="2a3e5-126">La mise à jour d’un thread d’interface utilisateur à partir d’un thread non-interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="2a3e5-126">Updating a UI thread from a non-UI thread</span></span>  
 <span data-ttu-id="2a3e5-127">Souvent, les threads de travail sont utilisés pour exécuter des tâches en arrière-plan qui implique la collecte de données à afficher dans l’interface utilisateur d’une application.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-127">Often, worker threads are used to perform some background work that involves gathering data to be displayed in an application's user interface.</span></span> <span data-ttu-id="2a3e5-128">Toutefois.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-128">However.</span></span> <span data-ttu-id="2a3e5-129">la plupart des infrastructures d’application (l’interface graphique utilisateur) pour le .NET Framework, tels que Windows Forms et Windows Presentation Foundation (WPF), vous permettent d’accéder aux objets de l’interface graphique utilisateur uniquement à partir du thread qui crée et gère l’interface utilisateur (le thread principal ou de l’interface utilisateur).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-129">most GUI (graphical user interface) application frameworks for the .NET Framework, such as Windows Forms and Windows Presentation Foundation (WPF),  let you access GUI objects only from the thread that creates and manages the UI (the Main or UI thread).</span></span> <span data-ttu-id="2a3e5-130">Un <xref:System.InvalidOperationException> est levée lorsque vous essayez d’accéder à un élément d’interface utilisateur à partir d’un thread autre que le thread d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-130">An <xref:System.InvalidOperationException> is thrown when you try to access a UI element from a thread other than the UI thread.</span></span>  <span data-ttu-id="2a3e5-131">Le texte du message d’exception est affiché dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-131">The text of the exception message is shown in the following table.</span></span>  
  
|<span data-ttu-id="2a3e5-132">Type d’application</span><span class="sxs-lookup"><span data-stu-id="2a3e5-132">Application Type</span></span>|<span data-ttu-id="2a3e5-133">Message</span><span class="sxs-lookup"><span data-stu-id="2a3e5-133">Message</span></span>|  
|----------------------|-------------|  
|<span data-ttu-id="2a3e5-134">Application WPF</span><span class="sxs-lookup"><span data-stu-id="2a3e5-134">WPF app</span></span>|<span data-ttu-id="2a3e5-135">**Le thread appelant ne peut pas accéder à cet objet, car un autre thread est propriétaire.**</span><span class="sxs-lookup"><span data-stu-id="2a3e5-135">**The calling thread cannot access this object because a different thread owns it.**</span></span>|  
|<span data-ttu-id="2a3e5-136">Application UWP</span><span class="sxs-lookup"><span data-stu-id="2a3e5-136">UWP app</span></span>|<span data-ttu-id="2a3e5-137">**L’application pour un autre thread a appelé une interface qui a été marshalée.**</span><span class="sxs-lookup"><span data-stu-id="2a3e5-137">**The application called an interface that was marshaled for a different thread.**</span></span>|  
|<span data-ttu-id="2a3e5-138">Application de Windows Forms</span><span class="sxs-lookup"><span data-stu-id="2a3e5-138">Windows Forms app</span></span>|<span data-ttu-id="2a3e5-139">**Opération inter-threads non valide : Contrôle 'TextBox1' accédé à partir d’un thread autre que le thread de création.**</span><span class="sxs-lookup"><span data-stu-id="2a3e5-139">**Cross-thread operation not valid: Control 'TextBox1' accessed from a thread other than the thread it was created on.**</span></span>|  
  
 <span data-ttu-id="2a3e5-140">Infrastructures d’interface utilisateur pour le .NET Framework implémentent un *répartiteur* modèle qui inclut une méthode pour vérifier si un appel à un membre d’un élément d’interface utilisateur est en cours d’exécution sur le thread d’interface utilisateur et autres méthodes permettant de planifier l’appel sur le thread d’interface utilisateur :</span><span class="sxs-lookup"><span data-stu-id="2a3e5-140">UI frameworks for the .NET Framework implement a *dispatcher* pattern that includes a method to check whether a call to a member of a UI element is being executed on the UI thread, and other methods to schedule the call on the UI thread:</span></span>  
  
-   <span data-ttu-id="2a3e5-141">Dans les applications WPF, appelez le <xref:System.Windows.Threading.Dispatcher.CheckAccess%2A?displayProperty=nameWithType> méthode pour déterminer si une méthode est en cours d’exécution sur un thread non-interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-141">In WPF apps, call the <xref:System.Windows.Threading.Dispatcher.CheckAccess%2A?displayProperty=nameWithType> method to determine if a method is running on a non-UI thread.</span></span> <span data-ttu-id="2a3e5-142">Elle retourne `true` si la méthode s’exécute sur le thread d’interface utilisateur et `false` dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-142">It returns `true` if the method is running on the UI thread and `false` otherwise.</span></span> <span data-ttu-id="2a3e5-143">Appelez une des surcharges de la <xref:System.Windows.Threading.Dispatcher.Invoke%2A?displayProperty=nameWithType> méthode permettant de planifier l’appel sur le thread d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-143">Call one of the overloads of the <xref:System.Windows.Threading.Dispatcher.Invoke%2A?displayProperty=nameWithType> method to schedule the call on the UI thread.</span></span>  
  
-   <span data-ttu-id="2a3e5-144">Dans les applications UWP, appelez le [CoreDispatcher.HasThreadAccess](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.hasthreadaccess.aspx) méthode pour déterminer si une méthode est en cours d’exécution sur un thread non-interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-144">In UWP apps, call the [CoreDispatcher.HasThreadAccess](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.hasthreadaccess.aspx) method to determine if a method is running on a non-UI thread.</span></span> <span data-ttu-id="2a3e5-145">Appelez le [CoreDispatcher.RunAsync](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.runasync.aspx) méthode à exécuter un délégué qui met à jour le thread d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-145">Call the  [CoreDispatcher.RunAsync](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.runasync.aspx) method to execute a delegate that updates the UI thread.</span></span> <span data-ttu-id="2a3e5-146">Utilisez la commande</span><span class="sxs-lookup"><span data-stu-id="2a3e5-146">Use the</span></span>  
  
-   <span data-ttu-id="2a3e5-147">Dans les applications Windows Forms, utilisez le <xref:System.Windows.Forms.Control.InvokeRequired%2A?displayProperty=nameWithType> propriété afin de déterminer si une méthode est en cours d’exécution sur un thread non-interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-147">In Windows Forms apps, use the <xref:System.Windows.Forms.Control.InvokeRequired%2A?displayProperty=nameWithType> property to determine if a method is running on a non-UI thread.</span></span> <span data-ttu-id="2a3e5-148">Appelez une des surcharges de la <xref:System.Windows.Forms.Control.Invoke%2A?displayProperty=nameWithType> méthode à exécuter un délégué qui met à jour le thread d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-148">Call one of the overloads of the <xref:System.Windows.Forms.Control.Invoke%2A?displayProperty=nameWithType> method to execute a delegate that updates the UI thread.</span></span>  
  
 <span data-ttu-id="2a3e5-149">Les exemples suivants illustrent le <xref:System.InvalidOperationException> exception qui est levée lorsque vous tentez de mettre à jour un élément d’interface utilisateur à partir d’un thread autre que le thread qui l’a créée.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-149">The following examples illustrate the <xref:System.InvalidOperationException> exception that is thrown when you attempt to update a UI element from a thread other than the thread that created it.</span></span>  <span data-ttu-id="2a3e5-150">Chaque exemple nécessite que vous créez deux contrôles :</span><span class="sxs-lookup"><span data-stu-id="2a3e5-150">Each example requires that you create two controls:</span></span>  
  
-   <span data-ttu-id="2a3e5-151">Un contrôle de zone de texte nommé `textBox1`.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-151">A text box control named `textBox1`.</span></span>  <span data-ttu-id="2a3e5-152">Dans une application Windows Forms, vous devez définir ses <xref:System.Windows.Forms.TextBox.Multiline%2A> propriété `true`.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-152">In a Windows Forms app, you should set its <xref:System.Windows.Forms.TextBox.Multiline%2A> property to `true`.</span></span>  
  
-   <span data-ttu-id="2a3e5-153">Un contrôle bouton nommé `threadExampleBtn`.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-153">A button  control named `threadExampleBtn`.</span></span> <span data-ttu-id="2a3e5-154">L’exemple fournit un gestionnaire, `ThreadsExampleBtn_Click`, pour le bouton `Click` événement.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-154">The example provides a handler, `ThreadsExampleBtn_Click`, for the button's `Click` event.</span></span>  
  
 <span data-ttu-id="2a3e5-155">Dans chaque cas, le `threadExampleBtn_Click` Gestionnaire d’événements appelle la `DoSomeWork` méthode deux fois.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-155">In each case, the `threadExampleBtn_Click` event handler calls the `DoSomeWork` method twice.</span></span> <span data-ttu-id="2a3e5-156">Le premier appel s’exécute de façon synchrone et réussit.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-156">The first call runs synchronously and succeeds.</span></span> <span data-ttu-id="2a3e5-157">Mais le deuxième appel, car il s’exécute en mode asynchrone sur un thread de pool, essaie de mettre à jour de l’interface utilisateur à partir d’un thread non-interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-157">But the second call, because it runs asynchronously on a thread pool thread, attempts to update the UI from a non-UI thread.</span></span> <span data-ttu-id="2a3e5-158">Il en résulte un <xref:System.InvalidOperationException> exception.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-158">This results in a <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="2a3e5-159">Applications WPF et UWP</span><span class="sxs-lookup"><span data-stu-id="2a3e5-159">WPF and UWP apps</span></span>  
 [!code-csharp[System.InvalidOperationException.Threading.WPF1#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf1/cs/MainWindow.xaml.cs#1)]
 [!code-vb[System.InvalidOperationException.Threading.WPF1#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf1/vb/MainWindow.xaml.vb#1)]  
  
 <span data-ttu-id="2a3e5-160">La version suivante de la `DoSomeWork` méthode élimine l’exception dans une application WPF.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-160">The following version of the `DoSomeWork` method eliminates the exception in a WPF app.</span></span>  
  
 [!code-csharp[System.InvalidOperationException.Threading.WPF2#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf2/cs/MainWindowDispatcher.xaml.cs#3)]
 [!code-vb[System.InvalidOperationException.Threading.WPF2#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf2/vb/MainWindowDispatcher.xaml.vb#3)]  
  
 <span data-ttu-id="2a3e5-161">La version suivante de la `DoSomeWork` méthode élimine l’exception dans une application UWP.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-161">The following version of the `DoSomeWork` method eliminates the exception in a UWP app.</span></span>  
  
 [!code-csharp[System.InvalidOperationException.Threading.UWP#4](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception.threading.uwp/cs/MainPage.xaml.cs#4)]
 [!code-vb[System.InvalidOperationException.Threading.UWP#4](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception.threading.uwp/vb/MainPage.xaml.vb#4)]  
  
 <span data-ttu-id="2a3e5-162">Applications Windows Forms</span><span class="sxs-lookup"><span data-stu-id="2a3e5-162">Windows Forms apps</span></span>  
 [!code-csharp[System.InvalidOperationException.Threading.WF#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf/cs/Form1.cs#2)]
 [!code-vb[System.InvalidOperationException.Threading.WF#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf/vb/Form1.vb#2)]  
  
 <span data-ttu-id="2a3e5-163">La version suivante de la `DoSomeWork` méthode élimine l’exception dans une application Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-163">The following version of the `DoSomeWork` method eliminates the exception in a Windows Forms app.</span></span>  
  
 [!code-csharp[System.InvalidOperationException.Threading.WF2#5](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf2/cs/Form1.cs#5)]
 [!code-vb[System.InvalidOperationException.Threading.WF2#5](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf2/vb/Form1.vb#5)]  
  
<a name="Iterating"></a>   
### <a name="changing-a-collection-while-iterating-it"></a><span data-ttu-id="2a3e5-164">Modification d’une collection lors de l’itération il</span><span class="sxs-lookup"><span data-stu-id="2a3e5-164">Changing a collection while iterating it</span></span>  
 <span data-ttu-id="2a3e5-165">Le `foreach` instruction en c# ou `For Each` instruction en Visual Basic est utilisée pour parcourir les membres d’une collection et pour lire ou modifier ses éléments individuels.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-165">The `foreach` statement in C# or `For Each` statement in Visual Basic is used to iterate the members of a collection and to read or modify its individual elements.</span></span> <span data-ttu-id="2a3e5-166">Toutefois, il ne peut pas être utilisé pour ajouter ou supprimer des éléments de la collection.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-166">However, it can't be used to add or remove items from the collection.</span></span> <span data-ttu-id="2a3e5-167">Cela lèverait une <xref:System.InvalidOperationException> exception avec un message qui est similaire, «**Collection a été modifiée ; opération d’énumération ne peut pas s’exécuter.** "</span><span class="sxs-lookup"><span data-stu-id="2a3e5-167">Doing this throws an  <xref:System.InvalidOperationException> exception with a message that is similar to, "**Collection was modified; enumeration operation may not execute.**"</span></span>  
  
 <span data-ttu-id="2a3e5-168">L’exemple suivant itère qu'une collection d’entiers tente d’ajouter le carré de chaque entier à la collection.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-168">The following example iterates a collection of integers attempts to add the square of each integer to the collection.</span></span> <span data-ttu-id="2a3e5-169">L’exemple lève une <xref:System.InvalidOperationException> avec le premier appel à la <xref:System.Collections.Generic.List%601.Add%2A?displayProperty=nameWithType> (méthode).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-169">The example throws an <xref:System.InvalidOperationException> with the first call to the <xref:System.Collections.Generic.List%601.Add%2A?displayProperty=nameWithType> method.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Iterating1.cs#1)]
 [!code-vb[System.InvalidOperationException#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Iterating1.vb#1)]  
  
 <span data-ttu-id="2a3e5-170">Vous pouvez éliminer l’exception de deux manières, selon votre logique d’application :</span><span class="sxs-lookup"><span data-stu-id="2a3e5-170">You can eliminate the exception in one of two ways, depending on your application logic:</span></span>  
  
-   <span data-ttu-id="2a3e5-171">Si les éléments doivent être ajoutés à la collection lors de l’itération à elle, vous pouvez le parcourir à l’aide des index le `for` instruction au lieu de `foreach` ou `For Each`.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-171">If elements must be added to the collection while iterating it, you can iterate it by index using the `for` statement instead of `foreach` or `For Each`.</span></span> <span data-ttu-id="2a3e5-172">L’exemple suivant utilise la pour instruction à ajouter le carré des nombres dans la collection à la collection.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-172">The following example uses the for statement to add the square of numbers in the collection to the collection.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Iterating2.cs#2)]
     [!code-vb[System.InvalidOperationException#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Iterating2.vb#2)]  
  
     <span data-ttu-id="2a3e5-173">Notez que vous devez établir le nombre d’itérations avant d’itérer la collection à l’aide d’un compteur à l’intérieur de la boucle qui abandonnera la boucle de manière appropriée, en effectuant une itération vers l’arrière, à partir de `Count` - 1 à 0, ou, comme dans l’exemple, en assignant le nombre d’éléments dans le tableau à une variable et l’utiliser pour établir la limite supérieure de la boucle.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-173">Note that you must establish the number of iterations before iterating the collection either by using a counter inside the loop that will exit the loop appropriately, by iterating backward, from `Count` - 1 to 0, or, as the example does, by assigning the number of elements in the array to a variable and using it to establish the upper bound of the loop.</span></span> <span data-ttu-id="2a3e5-174">Sinon, si un élément est ajouté à la collection à chaque itération, une boucle sans fin les résultats.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-174">Otherwise, if an element is added to the collection on every iteration, an endless loop results.</span></span>  
  
-   <span data-ttu-id="2a3e5-175">Si elle n’est pas nécessaire d’ajouter des éléments à la collection pendant l’itération il, vous pouvez stocker les éléments à ajouter dans un regroupement temporaire que vous ajoutez lors de l’itération de la collection est terminée.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-175">If it is not necessary to add elements to the collection while iterating it, you can store the elements to be added in a temporary collection that you add when iterating the collection has finished.</span></span>  <span data-ttu-id="2a3e5-176">L’exemple suivant utilise cette approche pour ajouter le carré des nombres dans une collection à un regroupement temporaire, puis pour combiner les collections dans un objet tableau unique.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-176">The following example uses this approach to add the square of numbers in a collection to a temporary collection, and then to combine the collections into a single array object.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Iterating3.cs#3)]
     [!code-vb[System.InvalidOperationException#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Iterating3.vb#3)]  
  
<a name="Sorting"></a>   
### <a name="sorting-an-array-or-collection-whose-objects-cannot-be-compared"></a><span data-ttu-id="2a3e5-177">Tri d’un tableau ou une collection dont les objets ne peuvent pas être comparées.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-177">Sorting an array or collection whose objects cannot be compared</span></span>  
 <span data-ttu-id="2a3e5-178">À usage général tri des méthodes, telles que la <xref:System.Array.Sort%28System.Array%29?displayProperty=nameWithType> (méthode) ou le <xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType> (méthode), nécessitent généralement qu’au moins un des objets à trier implémenter le <xref:System.IComparable%601> ou le <xref:System.IComparable> interface.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-178">General-purpose sorting methods, such as the <xref:System.Array.Sort%28System.Array%29?displayProperty=nameWithType> method or the <xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType> method, usually require that at least one of the objects to be sorted implement the <xref:System.IComparable%601> or the <xref:System.IComparable> interface.</span></span> <span data-ttu-id="2a3e5-179">Si non, la collection ou un tableau ne peuvent pas être trié, et la méthode lève un <xref:System.InvalidOperationException> exception.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-179">If not, the collection or array cannot be sorted, and the method throws an  <xref:System.InvalidOperationException> exception.</span></span> <span data-ttu-id="2a3e5-180">L’exemple suivant définit un `Person` classe stocke deux `Person` objets dans un modèle générique <xref:System.Collections.Generic.List%601> objet et tente de les trier.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-180">The following example defines a `Person` class, stores two `Person` objects in a generic <xref:System.Collections.Generic.List%601> object, and attempts to sort them.</span></span> <span data-ttu-id="2a3e5-181">Comme la sortie de l’exemple, l’appel à la <xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType> méthode lève un <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-181">As the output from the example shows, the call to the <xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType> method throws an <xref:System.InvalidOperationException>.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#12](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort1.cs#12)]
 [!code-vb[System.InvalidOperationException#12](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort1.vb#12)]  
  
 <span data-ttu-id="2a3e5-182">Vous pouvez éliminer l’exception dans une des trois manières :</span><span class="sxs-lookup"><span data-stu-id="2a3e5-182">You can eliminate the exception in any of three ways:</span></span>  
  
-   <span data-ttu-id="2a3e5-183">Si vous pouvez être propriétaire du type que vous essayez de trier (autrement dit, si vous contrôler son code source), vous pouvez le modifier pour implémenter le <xref:System.IComparable%601> ou <xref:System.IComparable> interface.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-183">If you can own the type that you are trying to sort (that is, if you control its source code), you can modify it to implement the <xref:System.IComparable%601> or the <xref:System.IComparable> interface.</span></span> <span data-ttu-id="2a3e5-184">Cela nécessite que vous implémentez soit le <xref:System.IComparable%601.CompareTo%2A?displayProperty=nameWithType> ou le <xref:System.IComparable.CompareTo%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-184">This requires that you implement either the <xref:System.IComparable%601.CompareTo%2A?displayProperty=nameWithType> or the <xref:System.IComparable.CompareTo%2A> method.</span></span> <span data-ttu-id="2a3e5-185">Ajout d’une implémentation d’interface à un type existant n’est pas une modification avec rupture.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-185">Adding an interface implementation to an existing type is not a breaking change.</span></span>  
  
     <span data-ttu-id="2a3e5-186">L’exemple suivant utilise cette approche pour fournir un <xref:System.IComparable%601> implémentation pour la `Person` classe.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-186">The following example uses this approach to provide an <xref:System.IComparable%601> implementation  for the `Person` class.</span></span> <span data-ttu-id="2a3e5-187">Vous pouvez toujours appeler la méthode de tri générales du tableau ou de la collection et, comme le montre la sortie de l’exemple, la collection trie avec succès.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-187">You can still call the collection or array's general sorting method and, as the output from the example shows, the collection sorts successfully.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#13](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort2.cs#13)]
     [!code-vb[System.InvalidOperationException#13](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort2.vb#13)]  
  
-   <span data-ttu-id="2a3e5-188">Si vous ne pouvez pas modifier le code source pour le type que vous voulez trier, vous pouvez définir une classe de tri à usage spécial qui implémente le <xref:System.Collections.Generic.IComparer%601> interface.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-188">If you cannot modify the source code for the type you are trying to sort, you can define a special-purpose sorting class that implements the <xref:System.Collections.Generic.IComparer%601> interface.</span></span>  <span data-ttu-id="2a3e5-189">Vous pouvez appeler une surcharge de la `Sort` méthode inclut un <xref:System.Collections.Generic.IComparer%601> paramètre.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-189">You can call an overload of the `Sort` method that includes an  <xref:System.Collections.Generic.IComparer%601> parameter.</span></span> <span data-ttu-id="2a3e5-190">Cette approche est particulièrement utile si vous souhaitez développer une classe spécialisée trie peut trier les objets selon plusieurs critères.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-190">This approach is especially useful if you want to develop a specialized sorting class that can sort objects based on multiple criteria.</span></span>  
  
     <span data-ttu-id="2a3e5-191">L’exemple suivant utilise l’approche en développant un personnalisé `PersonComparer` classe qui sert à trier `Person` collections.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-191">The following example uses the approach by developing a custom `PersonComparer` class that is used to sort `Person` collections.</span></span>  <span data-ttu-id="2a3e5-192">Il passe ensuite une instance de cette classe pour le <xref:System.Collections.Generic.List%601.Sort%28System.Collections.Generic.IComparer%7B%600%7D%29?displayProperty=nameWithType> (méthode).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-192">It then passes an instance of this class to the <xref:System.Collections.Generic.List%601.Sort%28System.Collections.Generic.IComparer%7B%600%7D%29?displayProperty=nameWithType> method.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#14](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort3.cs#14)]
     [!code-vb[System.InvalidOperationException#14](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort3.vb#14)]  
  
-   <span data-ttu-id="2a3e5-193">Si vous ne pouvez pas modifier le code source pour le type que vous voulez trier, vous pouvez créer un <xref:System.Comparison%601> délégué pour effectuer le tri.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-193">If you cannot modify the source code for the type you are trying to sort, you can create a  <xref:System.Comparison%601> delegate to perform the sorting.</span></span> <span data-ttu-id="2a3e5-194">La signature du délégué est</span><span class="sxs-lookup"><span data-stu-id="2a3e5-194">The delegate signature is</span></span>  
  
    ```vb  
    Function Comparison(Of T)(x As T, y As T) As Integer  
    ```  
  
    ```csharp  
    int Comparison<T>(T x, T y)  
    ```  
  
     <span data-ttu-id="2a3e5-195">L’exemple suivant utilise l’approche en définissant un `PersonComparison` méthode qui correspond à la <xref:System.Comparison%601> signature du délégué.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-195">The following example uses the approach by defining a  `PersonComparison` method that matches the  <xref:System.Comparison%601> delegate signature.</span></span>  <span data-ttu-id="2a3e5-196">Il passe ensuite ce délégué à la <xref:System.Collections.Generic.List%601.Sort%28System.Comparison%7B%600%7D%29?displayProperty=nameWithType> (méthode).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-196">It then passes this delegate to the <xref:System.Collections.Generic.List%601.Sort%28System.Comparison%7B%600%7D%29?displayProperty=nameWithType> method.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#15](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort4.cs#15)]
     [!code-vb[System.InvalidOperationException#15](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort4.vb#15)]  
  
<a name="Nullable"></a>   
### <a name="casting-a-nullablet-that-is-null-to-its-underlying-type"></a><span data-ttu-id="2a3e5-197">Conversion d’un type Nullable\<T > qui a la valeur null en son type sous-jacent</span><span class="sxs-lookup"><span data-stu-id="2a3e5-197">Casting a Nullable\<T> that is null to its underlying type</span></span>  
 <span data-ttu-id="2a3e5-198">Tentative de cast un <xref:System.Nullable%601> valeur qui est `null` à son type sous-jacent lève une <xref:System.InvalidOperationException> exception et affiche le message d’erreur «**objet Nullable doit avoir une valeur.**</span><span class="sxs-lookup"><span data-stu-id="2a3e5-198">Attempting to cast a <xref:System.Nullable%601> value that is `null` to its underlying type throws an <xref:System.InvalidOperationException> exception  and displays the error message, "**Nullable object must have a value.**</span></span>  
  
 <span data-ttu-id="2a3e5-199">L’exemple suivant lève une <xref:System.InvalidOperationException> exception lorsqu’il tente d’effectuer une itération d’un tableau qui inclut un `Nullable(Of Integer)` valeur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-199">The following example throws an <xref:System.InvalidOperationException> exception  when it attempts to iterate an array that includes a `Nullable(Of Integer)` value.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#4](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Nullable1.cs#4)]
 [!code-vb[System.InvalidOperationException#4](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Nullable1.vb#4)]  
  
 <span data-ttu-id="2a3e5-200">Pour empêcher l’exception :</span><span class="sxs-lookup"><span data-stu-id="2a3e5-200">To prevent the exception:</span></span>  
  
-   <span data-ttu-id="2a3e5-201">Utilisez le <xref:System.Nullable%601.HasValue%2A?displayProperty=nameWithType> propriété pour sélectionner uniquement les éléments qui ne sont pas `null`.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-201">Use the <xref:System.Nullable%601.HasValue%2A?displayProperty=nameWithType> property to select only those elements that are not `null`.</span></span>  
  
-   <span data-ttu-id="2a3e5-202">Appelez une de la <xref:System.Nullable%601.GetValueOrDefault%2A?displayProperty=nameWithType> surcharges pour fournir une valeur par défaut pour un `null` valeur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-202">Call one of the <xref:System.Nullable%601.GetValueOrDefault%2A?displayProperty=nameWithType> overloads to provide a default value for a `null` value.</span></span>  
  
 <span data-ttu-id="2a3e5-203">L’exemple suivant effectue les deux pour éviter le <xref:System.InvalidOperationException> exception.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-203">The following example does both to avoid the  <xref:System.InvalidOperationException> exception.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#5](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Nullable2.cs#5)]
 [!code-vb[System.InvalidOperationException#5](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Nullable2.vb#5)]  
  
<a name="Empty"></a>   
### <a name="calling-a-systemlinqenumerable-method-on-an-empty-collection"></a><span data-ttu-id="2a3e5-204">Appeler une méthode System.Linq.Enumerable sur une collection vide</span><span class="sxs-lookup"><span data-stu-id="2a3e5-204">Calling a System.Linq.Enumerable method on an empty collection</span></span>  
 <span data-ttu-id="2a3e5-205">Le <xref:System.Linq.Enumerable.Aggregate%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Max%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Min%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>, et <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> méthodes effectuer des opérations sur une séquence et retourner un résultat unique.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-205">The <xref:System.Linq.Enumerable.Aggregate%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Max%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Min%2A?displayProperty=nameWithType>,  <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>, and <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> methods perform operations on a sequence and return a single result.</span></span>   <span data-ttu-id="2a3e5-206">Certaines surcharges de ces méthodes lèvent une <xref:System.InvalidOperationException> exception lorsque la séquence est vide, alors que les autres surcharges retournent `null`.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-206">Some overloads of these methods throw an <xref:System.InvalidOperationException> exception when the sequence is empty, while other overloads return `null`.</span></span> <span data-ttu-id="2a3e5-207">Le <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> méthode lève également une <xref:System.InvalidOperationException> exception lorsque la séquence contient plusieurs éléments.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-207">The <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method also throws an <xref:System.InvalidOperationException> exception when the sequence contains more than one element.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2a3e5-208">La plupart des méthodes qui lèvent une <xref:System.InvalidOperationException> exception sont des surcharges.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-208">Most of the methods that throw an <xref:System.InvalidOperationException> exception are overloads.</span></span> <span data-ttu-id="2a3e5-209">N’oubliez pas que vous comprenez le comportement de la surcharge que vous choisissez.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-209">Be sure that you understand the behavior of the overload that you choose.</span></span>  
  
 <span data-ttu-id="2a3e5-210">Le tableau suivant répertorie les messages d’exception à partir de la <xref:System.InvalidOperationException> objets d’exception levées par les appels à certaines <xref:System.Linq.Enumerable?displayProperty=nameWithType> méthodes.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-210">The following table lists the exception messages from the <xref:System.InvalidOperationException> exception objects thrown by calls to some <xref:System.Linq.Enumerable?displayProperty=nameWithType> methods.</span></span>  
  
|<span data-ttu-id="2a3e5-211">Méthode</span><span class="sxs-lookup"><span data-stu-id="2a3e5-211">Method</span></span>|<span data-ttu-id="2a3e5-212">Message</span><span class="sxs-lookup"><span data-stu-id="2a3e5-212">Message</span></span>|  
|------------|-------------|  
|`Aggregate` <br /> `Average` <br /> `Last` <br /> `Max` <br /> `Min`|<span data-ttu-id="2a3e5-213">**Séquence ne contient aucun élément**</span><span class="sxs-lookup"><span data-stu-id="2a3e5-213">**Sequence contains no elements**</span></span>|  
|`First`|<span data-ttu-id="2a3e5-214">**Séquence ne contient aucun élément correspondant**</span><span class="sxs-lookup"><span data-stu-id="2a3e5-214">**Sequence contains no matching element**</span></span>|  
|`Single` <br /> `SingleOrDefault`|<span data-ttu-id="2a3e5-215">**Séquence contient plusieurs éléments correspondants**</span><span class="sxs-lookup"><span data-stu-id="2a3e5-215">**Sequence contains more than one matching element**</span></span>|  
  
 <span data-ttu-id="2a3e5-216">Comment supprimer ou gérer l’exception dépend les hypothèses de votre application et de la méthode particulière, que vous appelez.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-216">How you eliminate or handle the exception depends on your application's assumptions and on the particular method you call.</span></span>  
  
-   <span data-ttu-id="2a3e5-217">Lorsque vous appelez délibérément une de ces méthodes sans vérifier pour une séquence vide, vous supposez que la séquence n’est pas vide et qu’une séquence vide est un événement inattendu.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-217">When you deliberately call one of these methods without checking for an empty sequence, you are assuming that the sequence is not empty, and that an empty sequence is an unexpected occurrence.</span></span> <span data-ttu-id="2a3e5-218">Dans ce cas, l’interception ou de nouveau l’exception est approprié.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-218">In this case, catching or rethrowing the exception is appropriate .</span></span>  
  
-   <span data-ttu-id="2a3e5-219">Si votre manquement à vérifier pour une séquence vide a été par inadvertance, vous pouvez appeler une des surcharges de la <xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType> surcharge pour déterminer si une séquence contient des éléments.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-219">If your failure to check for an empty sequence was inadvertent, you can  call one of the overloads of the <xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType> overload to determine whether a sequence contains any elements.</span></span>  
  
    > [!TIP]
    >  <span data-ttu-id="2a3e5-220">Appelant le <xref:System.Linq.Enumerable.Any%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> avant de générer une séquence peut améliorer les performances si les données de traitement peuvent contenir un grand nombre d’éléments ou si l’opération qui génère la séquence est coûteuse.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-220">Calling the <xref:System.Linq.Enumerable.Any%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> method before generating a sequence can improve performance if the data to be processed might contain a large number of elements or if operation that generates the sequence is expensive.</span></span>  
  
-   <span data-ttu-id="2a3e5-221">Si vous avez appelé une méthode comme <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>, ou <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>, vous pouvez remplacer par une autre méthode, tel que <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.LastOrDefault%2A?displayProperty=nameWithType>, ou <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>, qui retourne une valeur par défaut au lieu d’un membre de la séquence.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-221">If you've called a method such as <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>, or <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>, you can substitute an alternate method, such as <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.LastOrDefault%2A?displayProperty=nameWithType>, or  <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>, that returns a default value instead of a member of the sequence.</span></span>  
  
 <span data-ttu-id="2a3e5-222">Les exemples fournissent des détails supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-222">The examples provide additional detail.</span></span>  
  
 <span data-ttu-id="2a3e5-223">L’exemple suivant utilise la <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType> méthode pour calculer la moyenne d’une séquence dont les valeurs sont supérieures à 4.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-223">The following example uses the <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType> method to compute the average of a sequence whose values are greater than 4.</span></span> <span data-ttu-id="2a3e5-224">Dans la mesure où aucune valeur à partir du tableau d’origine ne dépasse 4, aucune valeur n’est inclus dans la séquence, et la méthode lève un <xref:System.InvalidOperationException> exception.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-224">Since no values from the original array exceed 4, no values are included in the sequence, and the method throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#6](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable1.cs#6)]
 [!code-vb[System.InvalidOperationException#6](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable1.vb#6)]  
  
 <span data-ttu-id="2a3e5-225">L’exception peut être éliminée en appelant le <xref:System.Linq.Enumerable.Any%2A> méthode pour déterminer si la séquence contient des éléments avant d’appeler la méthode qui traite la séquence, comme le montre l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-225">The exception can be eliminated by calling the <xref:System.Linq.Enumerable.Any%2A> method to determine whether the sequence contains any elements before calling the method that processes the sequence, as the following example shows.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#7](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable2.cs#7)]
 [!code-vb[System.InvalidOperationException#7](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable2.vb#7)]  
  
 <span data-ttu-id="2a3e5-226">Le <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> méthode retourne le premier élément dans une séquence ou le premier élément dans une séquence qui satisfait à une condition spécifiée.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-226">The <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> method returns the first item in a sequence or the first element in a sequence that satisfies a specified condition.</span></span> <span data-ttu-id="2a3e5-227">Si la séquence est vide et n’a donc pas un premier élément, elle lève une <xref:System.InvalidOperationException> exception.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-227">If the sequence is empty and therefore does not have a first element, it throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="2a3e5-228">Dans l’exemple suivant, le <xref:System.Linq.Enumerable.First%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> méthode lève un <xref:System.InvalidOperationException> exception, car le tableau de dbQueryResults ne contient aucun élément supérieur à 4.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-228">In the following example, the <xref:System.Linq.Enumerable.First%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> method throws an <xref:System.InvalidOperationException> exception because the dbQueryResults array doesn't contain an element greater than 4.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#8](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable3.cs#8)]
 [!code-vb[System.InvalidOperationException#8](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable3.vb#8)]  
  
 <span data-ttu-id="2a3e5-229">Vous pouvez appeler la <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType> méthode au lieu de <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> pour retourner un spécifié ou la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-229">You can call the <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType> method instead of <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> to return a specified or default value.</span></span> <span data-ttu-id="2a3e5-230">Si la méthode ne trouve pas un premier élément dans la séquence, elle retourne la valeur par défaut pour ce type de données.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-230">If the method does not find a first element in the sequence, it returns  the default value for that data type.</span></span>  <span data-ttu-id="2a3e5-231">La valeur par défaut est `null` pour un type référence, zéro pour un type de données numérique et <xref:System.DateTime.MinValue?displayProperty=nameWithType> pour la <xref:System.DateTime> type.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-231">The default value is `null` for a reference type, zero for a numeric data type, and <xref:System.DateTime.MinValue?displayProperty=nameWithType> for the <xref:System.DateTime> type.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2a3e5-232">Interprétation de la valeur retournée par la <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType> méthode est souvent compliquée par le fait que la valeur par défaut du type peut être une valeur valide dans la séquence.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-232">Interpreting the value returned by the <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType> method is often complicated by the fact that the default value of the type can be a valid value in the sequence.</span></span> <span data-ttu-id="2a3e5-233">Dans ce cas, vous un appel de la <xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType> méthode pour déterminer si la séquence a des membres valides avant d’appeler le <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> (méthode).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-233">In this case, you an call the <xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType> method to determine whether the sequence has valid members before calling the <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="2a3e5-234">L’exemple suivant appelle la <xref:System.Linq.Enumerable.FirstOrDefault%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> méthode pour empêcher le <xref:System.InvalidOperationException> exception levée dans l’exemple précédent.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-234">The following example calls the  <xref:System.Linq.Enumerable.FirstOrDefault%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> method to prevent the <xref:System.InvalidOperationException> exception thrown in the previous example.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#9](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable4.cs#9)]
 [!code-vb[System.InvalidOperationException#9](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable4.vb#9)]  
  
<a name="Single"></a>   
### <a name="calling-enumerablesingle-or-enumerablesingleordefault-on-a-sequence-without-one-element"></a><span data-ttu-id="2a3e5-235">L’appel Enumerable.Single ou Enumerable.SingleOrDefault sur une séquence sans un seul élément</span><span class="sxs-lookup"><span data-stu-id="2a3e5-235">Calling Enumerable.Single or Enumerable.SingleOrDefault on a sequence without one element</span></span>  
 <span data-ttu-id="2a3e5-236">Le <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> méthode retourne le seul élément d’une séquence ou le seul élément d’une séquence qui répond à une condition spécifiée.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-236">The <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> method returns the only element of a sequence, or the only element of a sequence that meets a specified condition.</span></span>    <span data-ttu-id="2a3e5-237">Si aucun élément dans la séquence, ou s’il existe plusieurs éléments, la méthode lève un <xref:System.InvalidOperationException> exception.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-237">If there are no elements in the sequence, or if there is more than one element , the method throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="2a3e5-238">Vous pouvez utiliser la <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> méthode pour retourner une valeur par défaut au lieu de lever une exception lorsque la séquence ne contient aucun élément.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-238">You can use the <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method to return a default value instead of throwing an exception when the sequence contains no elements.</span></span> <span data-ttu-id="2a3e5-239">Toutefois, le <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> méthode lève toujours une <xref:System.InvalidOperationException> exception lorsque la séquence contient plusieurs éléments.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-239">However, the <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method still throws an <xref:System.InvalidOperationException> exception  when the sequence contains more than one element.</span></span>  
  
 <span data-ttu-id="2a3e5-240">Le tableau suivant répertorie les messages d’exception à partir de la <xref:System.InvalidOperationException> objets d’exception levées par les appels à la <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> et <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> méthodes.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-240">The following table lists the exception messages from the <xref:System.InvalidOperationException> exception objects thrown by calls to the <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> and <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> methods.</span></span>  
  
|<span data-ttu-id="2a3e5-241">Méthode</span><span class="sxs-lookup"><span data-stu-id="2a3e5-241">Method</span></span>|<span data-ttu-id="2a3e5-242">Message</span><span class="sxs-lookup"><span data-stu-id="2a3e5-242">Message</span></span>|  
|------------|-------------|  
|`Single`|<span data-ttu-id="2a3e5-243">**Séquence ne contient aucun élément correspondant**</span><span class="sxs-lookup"><span data-stu-id="2a3e5-243">**Sequence contains no matching element**</span></span>|  
|`Single` <br /> `SingleOrDefault`|<span data-ttu-id="2a3e5-244">**Séquence contient plusieurs éléments correspondants**</span><span class="sxs-lookup"><span data-stu-id="2a3e5-244">**Sequence contains more than one matching element**</span></span>|  
  
 <span data-ttu-id="2a3e5-245">Dans l’exemple suivant, l’appel à la <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> méthode lève un <xref:System.InvalidOperationException> exception parce que la séquence ne contient aucun élément supérieur à 4.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-245">In the following example, the call to the <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> method throws an <xref:System.InvalidOperationException> exception because the sequence doesn't have an element greater than 4.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#10](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable5.cs#10)]
 [!code-vb[System.InvalidOperationException#10](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable5.vb#10)]  
  
 <span data-ttu-id="2a3e5-246">L’exemple suivant tente d’empêcher la <xref:System.InvalidOperationException> exception levée lorsqu’une séquence est vide en appelant à la place le <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> (méthode).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-246">The following example attempts to prevent the <xref:System.InvalidOperationException> exception thrown when a sequence is empty by instead calling the <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="2a3e5-247">Toutefois, étant donné que cette séquence retourne plusieurs éléments dont la valeur est supérieure à 2, elle lève également une <xref:System.InvalidOperationException> exception.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-247">However, because this sequence returns multiple elements whose value is greater than 2, it also throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#11](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable6.cs#11)]
 [!code-vb[System.InvalidOperationException#11](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable6.vb#11)]  
  
 <span data-ttu-id="2a3e5-248">Appel de la <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> méthode part du principe qu’une séquence ou la séquence qui répond aux critères spécifiés ne contient qu’un seul élément.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-248">Calling the <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> method assumes that either a sequence or the sequence that meets specified criteria contains only one element.</span></span>  <span data-ttu-id="2a3e5-249"><xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> suppose une séquence avec zéro ou un résultat, mais pas plus.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-249"><xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> assumes a sequence with zero or one result, but no more.</span></span> <span data-ttu-id="2a3e5-250">Si cette hypothèse est délibérée de votre part et que ces conditions ne sont pas remplies, nouvelle levée ou l’interception résultant <xref:System.InvalidOperationException> est appropriée.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-250">If this assumption is a deliberate one on your part and these conditions are not met, rethrowing or catching the resulting <xref:System.InvalidOperationException> is appropriate.</span></span> <span data-ttu-id="2a3e5-251">Dans le cas contraire, ou si vous prévoyez que les conditions non valides seront produit à une certaine fréquence, vous devez envisager d’utiliser un autre <xref:System.Linq.Enumerable> (méthode), tel que <xref:System.Linq.Enumerable.FirstOrDefault%2A> ou <xref:System.Linq.Enumerable.Where%2A>.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-251">Otherwise, or if you expect that invalid conditions will occur with some frequency, you should consider using some other <xref:System.Linq.Enumerable> method, such as <xref:System.Linq.Enumerable.FirstOrDefault%2A> or <xref:System.Linq.Enumerable.Where%2A>.</span></span>  
  
<a name="Emit"></a>   
### <a name="dynamic-cross-application-domain-field-access"></a><span data-ttu-id="2a3e5-252">Accès aux champs de domaine d’applications croisées dynamiques</span><span class="sxs-lookup"><span data-stu-id="2a3e5-252">Dynamic cross-application domain field access</span></span>  
 <span data-ttu-id="2a3e5-253">Le <xref:System.Reflection.Emit.OpCodes.Ldflda?displayProperty=nameWithType> Microsoft intermediate language (MSIL) instruction lève une <xref:System.InvalidOperationException> exception si l’objet qui contient le champ dont vous essayez de récupérer l’adresse n’est pas dans le domaine d’application dans lequel votre code s’exécute.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-253">The <xref:System.Reflection.Emit.OpCodes.Ldflda?displayProperty=nameWithType> Microsoft intermediate language (MSIL) instruction throws an <xref:System.InvalidOperationException> exception if the object containing the field whose address you are trying to retrieve is not within the application domain in which your code is executing.</span></span> <span data-ttu-id="2a3e5-254">L’adresse d’un champ est uniquement accessible à partir du domaine d’application dans lequel il réside.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-254">The address of a field can only be accessed from the application domain in which it resides.</span></span>  
  
<a name="Throwing"></a>   
## <a name="throwing-an-invalidoperationexception-exception"></a><span data-ttu-id="2a3e5-255">Lever une exception InvalidOperationException</span><span class="sxs-lookup"><span data-stu-id="2a3e5-255">Throwing an InvalidOperationException exception</span></span>  
 <span data-ttu-id="2a3e5-256">Vous devez lever une <xref:System.InvalidOperationException> exception uniquement lorsque l’état de votre objet pour une raison quelconque ne prend pas en charge un appel de méthode particulier.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-256">You should throw an <xref:System.InvalidOperationException> exception only when the state of your object for some reason does not support a particular method call.</span></span> <span data-ttu-id="2a3e5-257">Autrement dit, l’appel de méthode n’est valide que dans certaines circonstances ou des contextes, mais n’est pas valide dans d’autres.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-257">That is, the method call is valid in some circumstances or contexts, but is invalid in others.</span></span>  
  
 <span data-ttu-id="2a3e5-258">Si l’échec d’appel de méthode est en raison d’arguments non valides, puis <xref:System.ArgumentException> ou l’une de ses classes dérivées, <xref:System.ArgumentNullException> ou <xref:System.ArgumentOutOfRangeException>, doit être levée à la place.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-258">If the method invocation failure is due to invalid arguments, then <xref:System.ArgumentException> or one of its derived classes, <xref:System.ArgumentNullException> or <xref:System.ArgumentOutOfRangeException>, should be thrown instead.</span></span>  
  
<a name="Misc"></a>   
## <a name="miscellaneous-information"></a><span data-ttu-id="2a3e5-259">Informations diverses</span><span class="sxs-lookup"><span data-stu-id="2a3e5-259">Miscellaneous information</span></span>  
 <span data-ttu-id="2a3e5-260"><xref:System.InvalidOperationException> utilise le HRESULT COR_E_INVALIDOPERATION dont la valeur est 0 x 80131509.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-260"><xref:System.InvalidOperationException> uses the HRESULT COR_E_INVALIDOPERATION, which has the value 0x80131509.</span></span>  
  
 <span data-ttu-id="2a3e5-261">Pour obtenir la liste des valeurs initiales des propriétés d’une instance de <xref:System.InvalidOperationException>, consultez le <xref:System.InvalidOperationException.%23ctor%2A> constructeurs.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-261">For a list of initial property values for an instance of <xref:System.InvalidOperationException>, see the <xref:System.InvalidOperationException.%23ctor%2A> constructors.</span></span>  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Exception" />
    <altmember cref="T:System.Collections.IEnumerator" />
    <altmember cref="T:System.Resources.ResourceSet" />
    <related type="Article" href="~/docs/standard/exceptions/index.md"><span data-ttu-id="2a3e5-262">Gestion et levée des exceptions</span><span class="sxs-lookup"><span data-stu-id="2a3e5-262">Handling and Throwing Exceptions</span></span></related>
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="2a3e5-263">Initialise une nouvelle instance de la classe <see cref="T:System.InvalidOperationException" />.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-263">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InvalidOperationException ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InvalidOperationException();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="2a3e5-264">Initialise une nouvelle instance de la classe <see cref="T:System.InvalidOperationException" />.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-264">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2a3e5-265">Ce constructeur initialise la <xref:System.Exception.Message%2A> propriété de la nouvelle instance à un message fourni par le système qui décrit l’erreur, tel que « l’opération demandée ne peut pas être effectuée. »</span><span class="sxs-lookup"><span data-stu-id="2a3e5-265">This constructor initializes the <xref:System.Exception.Message%2A> property of the new instance to a system-supplied message that describes the error, such as "The requested operation cannot be performed."</span></span> <span data-ttu-id="2a3e5-266">Ce message prend en compte la culture système en cours.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-266">This message takes into account the current system culture.</span></span>  
  
 <span data-ttu-id="2a3e5-267">Le tableau suivant montre les valeurs initiales des propriétés d'une instance de <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-267">The following table shows the initial property values for an instance of <xref:System.InvalidOperationException>.</span></span>  
  
|<span data-ttu-id="2a3e5-268">Property</span><span class="sxs-lookup"><span data-stu-id="2a3e5-268">Property</span></span>|<span data-ttu-id="2a3e5-269">Value</span><span class="sxs-lookup"><span data-stu-id="2a3e5-269">Value</span></span>|  
|--------------|-----------|  
|<xref:System.Exception.InnerException%2A>|<span data-ttu-id="2a3e5-270">Référence Null (`Nothing` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-270">A null reference (`Nothing` in Visual Basic).</span></span>|  
|<xref:System.Exception.Message%2A>|<span data-ttu-id="2a3e5-271">Chaîne du message d'erreur localisé.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-271">The localized error message string.</span></span>|  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InvalidOperationException (string message);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InvalidOperationException(System::String ^ message);" />
      <MemberSignature Language="F#" Value="new InvalidOperationException : string -&gt; InvalidOperationException" Usage="new System.InvalidOperationException message" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="2a3e5-272">Message décrivant l'erreur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-272">The message that describes the error.</span></span></param>
        <summary><span data-ttu-id="2a3e5-273">Initialise une nouvelle instance de la classe <see cref="T:System.InvalidOperationException" /> avec un message d'erreur spécifié.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-273">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class with a specified error message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2a3e5-274">Ce constructeur initialise la <xref:System.Exception.Message%2A?displayProperty=nameWithType> propriété de l’exception à l’aide du `message` paramètre.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-274">This constructor initializes the <xref:System.Exception.Message%2A?displayProperty=nameWithType> property of the new exception using the `message` parameter.</span></span> <span data-ttu-id="2a3e5-275">Le contenu de `message` doit être compréhensible par les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-275">The content of `message` is intended to be understood by humans.</span></span> <span data-ttu-id="2a3e5-276">L'appelant de ce constructeur doit vérifier que cette chaîne a été localisée pour la culture en cours du système.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-276">The caller of this constructor is required to ensure that this string has been localized for the current system culture.</span></span>  
  
 <span data-ttu-id="2a3e5-277">Le tableau suivant montre les valeurs initiales des propriétés d'une instance de <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-277">The following table shows the initial property values for an instance of <xref:System.InvalidOperationException>.</span></span>  
  
|<span data-ttu-id="2a3e5-278">Property</span><span class="sxs-lookup"><span data-stu-id="2a3e5-278">Property</span></span>|<span data-ttu-id="2a3e5-279">Value</span><span class="sxs-lookup"><span data-stu-id="2a3e5-279">Value</span></span>|  
|--------------|-----------|  
|<xref:System.Exception.InnerException%2A>|<span data-ttu-id="2a3e5-280">Référence Null (`Nothing` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-280">A null reference (`Nothing` in Visual Basic).</span></span>|  
|<xref:System.Exception.Message%2A>|<span data-ttu-id="2a3e5-281">Chaîne du message d'erreur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-281">The error message string.</span></span>|  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="protected InvalidOperationException (System.Runtime.Serialization.SerializationInfo info, System.Runtime.Serialization.StreamingContext context);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig specialname rtspecialname instance void .ctor(class System.Runtime.Serialization.SerializationInfo info, valuetype System.Runtime.Serialization.StreamingContext context) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor(System.Runtime.Serialization.SerializationInfo,System.Runtime.Serialization.StreamingContext)" />
      <MemberSignature Language="VB.NET" Value="Protected Sub New (info As SerializationInfo, context As StreamingContext)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; InvalidOperationException(System::Runtime::Serialization::SerializationInfo ^ info, System::Runtime::Serialization::StreamingContext context);" />
      <MemberSignature Language="F#" Value="new InvalidOperationException : System.Runtime.Serialization.SerializationInfo * System.Runtime.Serialization.StreamingContext -&gt; InvalidOperationException" Usage="new System.InvalidOperationException (info, context)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters>
        <Parameter Name="info" Type="System.Runtime.Serialization.SerializationInfo" Index="0" FrameworkAlternate="netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;netstandard-2.0;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0;netstandard-2.1" />
        <Parameter Name="context" Type="System.Runtime.Serialization.StreamingContext" Index="1" FrameworkAlternate="netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;netstandard-2.0;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0;netstandard-2.1" />
      </Parameters>
      <Docs>
        <param name="info"><span data-ttu-id="2a3e5-282">Objet qui contient les données sérialisées de l'objet.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-282">The object that holds the serialized object data.</span></span></param>
        <param name="context"><span data-ttu-id="2a3e5-283">Informations contextuelles sur la source ou la destination.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-283">The contextual information about the source or destination.</span></span></param>
        <summary><span data-ttu-id="2a3e5-284">Initialise une nouvelle instance de la classe <see cref="T:System.InvalidOperationException" /> avec des données sérialisées.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-284">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class with serialized data.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2a3e5-285">Ce constructeur est appelé lors de la désérialisation pour reconstituer l’objet exception transmis sur un flux.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-285">This constructor is called during deserialization to reconstitute the exception object transmitted over a stream.</span></span> <span data-ttu-id="2a3e5-286">Pour plus d’informations, consultez [sérialisation XML et SOAP](~/docs/standard/serialization/xml-and-soap-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="2a3e5-286">For more information, see [XML and SOAP Serialization](~/docs/standard/serialization/xml-and-soap-serialization.md).</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="~/docs/standard/serialization/xml-and-soap-serialization.md"><span data-ttu-id="2a3e5-287">Sérialisation XML et SOAP</span><span class="sxs-lookup"><span data-stu-id="2a3e5-287">XML and SOAP Serialization</span></span></related>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InvalidOperationException (string message, Exception innerException);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string message, class System.Exception innerException) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor(System.String,System.Exception)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (message As String, innerException As Exception)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InvalidOperationException(System::String ^ message, Exception ^ innerException);" />
      <MemberSignature Language="F#" Value="new InvalidOperationException : string * Exception -&gt; InvalidOperationException" Usage="new System.InvalidOperationException (message, innerException)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="innerException" Type="System.Exception" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="2a3e5-288">Message d'erreur qui explique la raison de l'exception.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-288">The error message that explains the reason for the exception.</span></span></param>
        <param name="innerException"><span data-ttu-id="2a3e5-289">Exception ayant provoqué l'exception actuelle.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-289">The exception that is the cause of the current exception.</span></span> <span data-ttu-id="2a3e5-290">Si le paramètre <paramref name="innerException" /> n'est pas une référence null (<see langword="Nothing" /> en Visual Basic), l'exception actuelle est levée dans un bloc <see langword="catch" /> qui gère l'exception interne.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-290">If the <paramref name="innerException" /> parameter is not a null reference (<see langword="Nothing" /> in Visual Basic), the current exception is raised in a <see langword="catch" /> block that handles the inner exception.</span></span></param>
        <summary><span data-ttu-id="2a3e5-291">Initialise une nouvelle instance de la classe <see cref="T:System.InvalidOperationException" /> avec un message d'erreur spécifié et une référence à l'exception interne ayant provoqué cette exception.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-291">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class with a specified error message and a reference to the inner exception that is the cause of this exception.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2a3e5-292">Une exception levée en conséquence directe d'une exception précédente doit contenir une référence à celle-ci dans la propriété <xref:System.Exception.InnerException%2A>.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-292">An exception that is thrown as a direct result of a previous exception should include a reference to the previous exception in the <xref:System.Exception.InnerException%2A> property.</span></span> <span data-ttu-id="2a3e5-293">La propriété <xref:System.Exception.InnerException%2A> retourne la même valeur que celle qui a été passée dans le constructeur ou une référence Null (`Nothing` en Visual Basic), si la propriété <xref:System.Exception.InnerException%2A> ne fournit pas la valeur de l'exception interne au constructeur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-293">The <xref:System.Exception.InnerException%2A> property returns the same value that is passed into the constructor, or a null reference (`Nothing` in Visual Basic) if the <xref:System.Exception.InnerException%2A> property does not supply the inner exception value to the constructor.</span></span>  
  
 <span data-ttu-id="2a3e5-294">Le tableau suivant montre les valeurs initiales des propriétés d'une instance de <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-294">The following table shows the initial property values for an instance of <xref:System.InvalidOperationException>.</span></span>  
  
|<span data-ttu-id="2a3e5-295">Property</span><span class="sxs-lookup"><span data-stu-id="2a3e5-295">Property</span></span>|<span data-ttu-id="2a3e5-296">Value</span><span class="sxs-lookup"><span data-stu-id="2a3e5-296">Value</span></span>|  
|--------------|-----------|  
|<xref:System.Exception.InnerException%2A>|<span data-ttu-id="2a3e5-297">La référence à l'exception interne.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-297">The inner exception reference.</span></span>|  
|<xref:System.Exception.Message%2A>|<span data-ttu-id="2a3e5-298">Chaîne du message d'erreur.</span><span class="sxs-lookup"><span data-stu-id="2a3e5-298">The error message string.</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Exception" />
        <related type="Article" href="~/docs/standard/exceptions/index.md"><span data-ttu-id="2a3e5-299">Gestion et levée des exceptions</span><span class="sxs-lookup"><span data-stu-id="2a3e5-299">Handling and Throwing Exceptions</span></span></related>
      </Docs>
    </Member>
  </Members>
</Type>